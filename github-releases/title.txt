Settings Window and better TMP handling